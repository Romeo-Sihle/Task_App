<?php

//INDEX.PHP
	//connecting to the database
	include_once 'includes/connect.php';

	if(isset($_POST['search']))
	{
		$search = $_POST['search'];
		$query = "SELECT * FROM task_table WHERE t_name LIKE '%$search%'";
		$result = mysqli_query($conn, $query);
	}

?>
<!DOCTYPE html>
<html>
<head>
	<title>To Do App</title>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
</head>

	<style>
		.todo
		{
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			border-radius: 5px;
			border: 2px solid #cccccc;
			margin-top: 5px;
		}

		.search
		{
			margin-top: 10px;
		}

	</style>
<body>
<div class="container">
	<div class="todo">
		<h1><a href="index.php">To Do App</a></h1>
		<h3>Add a New Task</h3>	
	</div>
	<div class="col-lg-4 search">
		<form action="search.php" method="post">
			<input type="text" class="form-control" name="search" placeholder="Search Task">
		</form>
	</div>
	<div class="table-responsive col-lg-12">
		<table class="table table-bordered table-striped table-hover">
			<thead>
				<th>ID</th>
				<th>TASK</th>
				<th>DATE ADDED</th>
				<th>DUE DATE</th>
				<th>EDIT TASK</th>
				<th>DELETE TASK</th>
			</thead>
			<tbody>
				<?php

					if(mysqli_num_rows($result) === 0)
					{
						echo "<tr>";
						echo "<td><h1 style='text-center'>N/A</h1></td>";
						echo "<td><h1 style='text-center'>No results found!</h1></td>";
						echo "<td><h1 style='text-center'>N/A</h1></td>";
						echo "<td><h1 style='text-center'>N/A</h1></td>";
						echo "<td><h1 style='text-center'>N/A</h1></td>";
						echo "<td><h1 style='text-center'>N/A</h1></td>";
						echo "<tr>";
					}
					else
					{					
						// success! check results
						while($row = mysqli_fetch_assoc($result))
						{
							$t_id = $row['t_id'];
							$t_name = $row['t_name'];
							$t_date = $row['t_date'];
							$t_ddate = $row['t_ddate'];

				?> 

					
							<tr>
								<td><?php echo $t_id; ?></td>
								<td><?php echo $t_name; ?></td>
								<td><?php echo $t_date; ?></td>
								<td><?php echo $t_ddate; ?></td>
								<td><a href="edit.php?edit-task=<?php echo $t_id; ?>" class="btn-primary">Edit Task</a></td>
								<td><a href="index.php?delete_task=<?php echo $t_id; ?>" class="btn-danger">Delete Task</a></td>
							</tr>
					<?php }}

					?> 

							
			</tbody>
		</table>
	</div>
</div>

</body>
</html>